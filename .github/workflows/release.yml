name: Release Obsidian plugin

on:
  push:
    tags:
      - "*"

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - uses: actions/checkout@v3

      - name: Use Node.js
        uses: actions/setup-node@v3
        with:
          node-version: "18.x"

      - name: Build plugin
        run: |
          npm install
          npm run build

      - name: Create release
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          tag="${GITHUB_REF#refs/tags/}"
          
          # Create release notes
          release_notes=$(cat << 'RELEASE_NOTES'
## ðŸš€ ì„±ëŠ¥ ìµœì í™” (Phase 1)
- **AI ëª¨ë“ˆ ì§€ì—° ë¡œë”©**: í•„ìš”í•  ë•Œë§Œ AI ì»´í¬ë„ŒíŠ¸ë¥¼ ë¡œë“œí•˜ì—¬ ì´ˆê¸° ì‹œìž‘ ì†ë„ í–¥ìƒ
- **ì½”ë“œ ë¶„í• **: AI_PROMPTS ë¶„ë¦¬ë¡œ íŠ¸ë¦¬ ì‰ì´í‚¹ ìµœì í™” í™œì„±í™”
- **ìŠ¤ë§ˆíŠ¸ ë¡œê¹…**: í™˜ê²½ë³„ ë¡œê¹… ë ˆë²¨ ìžë™ ì„¤ì •ìœ¼ë¡œ í”„ë¡œë•ì…˜ íš¨ìœ¨ì„± ì¦ëŒ€

## ðŸŽ¨ AI ë²„íŠ¼ ì‚¬ìš©ìž ê²½í—˜ ê°œì„ 
- **ëª…í™•í•œ ì‹œê°ì  í”¼ë“œë°±**: AI ì„œë¹„ìŠ¤ ë¹„í™œì„±í™” ìƒíƒœë¥¼ ì¦‰ì‹œ ì¸ì‹ ê°€ëŠ¥
- **ìœ ìš©í•œ íˆ´íŒ**: AI ì„¤ì • ë°©ë²•ì— ëŒ€í•œ ìƒì„¸í•œ ê°€ì´ë“œ ì œê³µ
- **ì¼ê´€ëœ ìƒíƒœ ê´€ë¦¬**: ëª¨ë“  ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì•ˆì •ì ì¸ ë²„íŠ¼ ìƒíƒœ ìœ ì§€

## ðŸ“Š ë²ˆë“¤ ë¶„ì„
- **main.js**: 355KB (ì§€ì—° ë¡œë”© ì¸í”„ë¼ë¡œ ìµœì í™”)
- **styles.css**: 35KB (í–¥ìƒëœ AI ìŠ¤íƒ€ì¼ë§ ë° ë°˜ì‘í˜• ë””ìžì¸)
- **ì½”ë“œ í’ˆì§ˆ**: 12,895ì¤„ì˜ ì„±ëŠ¥ ìµœì í™” í”„ë ˆìž„ì›Œí¬

## ðŸ”§ ê¸°ìˆ ì  ê°œì„ ì‚¬í•­
- **ì™„ì „í•œ ë¹„ë™ê¸° í˜¸í™˜ì„±**: async/await íŒ¨í„´ìœ¼ë¡œ í–¥ìƒëœ AI ì„œë¹„ìŠ¤ í†µí•©
- **ë©”ëª¨ë¦¬ ìµœì í™”**: í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ
- **CSS ëª¨ë“ˆí™”**: ë” ë‚˜ì€ ìœ ì§€ë³´ìˆ˜ì„±ê³¼ í…Œë§ˆ ì§€ì›

## âœ¨ ì‚¬ìš©ìž ê²½í—˜
- **ì¦‰ì‹œ AI ìƒíƒœ ì¸ì‹**: ì‚¬ìš©ìžê°€ AI ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ë¥¼ ì¦‰ì‹œ í™•ì¸ ê°€ëŠ¥
- **ì„¤ì • ê°€ì´ë“œ**: AI ì œê³µìž ì„¤ì •ì— ëŒ€í•œ ëª…í™•í•œ ì•ˆë‚´
- **ì¼ê´€ëœ ì¸í„°íŽ˜ì´ìŠ¤**: ë°ìŠ¤í¬í†±ê³¼ ëª¨ë°”ì¼ì—ì„œ ë™ì¼í•œ ë™ìž‘

ì´ë²ˆ ë¦´ë¦¬ì¦ˆëŠ” ê¸°ëŠ¥ ì™„ì„±ë„ë¥¼ ìœ ì§€í•˜ë©´ì„œ ì„±ëŠ¥ ìµœì í™”ì— ì¤‘ì ì„ ë‘ê³ , AI ê¸°ëŠ¥ ê´€ë ¨ ì‚¬ìš©ìž ê²½í—˜ì„ í¬ê²Œ ê°œì„ í–ˆìŠµë‹ˆë‹¤.
RELEASE_NOTES
)
          
          gh release create "$tag" \
            --title="$tag - ì„±ëŠ¥ ìµœì í™” ë° AI ì‚¬ìš©ìž ê²½í—˜ ê°œì„ " \
            --notes="$release_notes" \
            --draft \
            main.js manifest.json styles.css